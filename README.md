<h2 align="center">Notes by Django</h2>

Backend API на Django Rest Framework для приложения по созданию приватных записок.
Fontend на Vue.js: https://github.com/ismirnov56/testworksimbirsoftfrontend

## Инструменты разработки

### Архитектура

При разработке данного приложеня было принято решение разделить реализацию backend и frontend. Для взаимодействия компонентов используется общепринятая REST архитектура.

**Причины**
- Уменьшение зависимостей между front и back (просто развивать, увеличивать функционал и изменять).
- Уменьшение времени разработки команда front не ждёт команду back.
- Кросплатформенность за счет использования общей архитектуры (Backend API могут пользоваться несколько приложений, мобильные, web, desktop).
Пример: приложение заказчика пользуется большой популярность он приходит к компании и просит сделать ещё мобильное
(могут возикнуть проблемы при сложной связанности приложения и разработчикам придётся переписывать многое.)
- Сниджение нагрузки на backend, ему присылают запросы только тогда кагда надо, и отпадает обходимость хранить 
и отдавать файлы верстки, стили (если бы мы допустим использовали django render) и часть валидации берет на себя frontend, что уменьшает количество запросов на back. 
- Backend определят бизнес логику, frontend визуал.


**Стек:**
- ***Backend:***
    - Django 
    - Django rest framework - некая надстройка над обычным django обеспечивающая быстрое создание REST API. (https://www.django-rest-framework.org/)
    - Djoser - хорошая библиотека для работы с аутентификацией (https://djoser.readthedocs.io/en/latest/)
    - Django ORM
    - Postgresql
    - Docker образы python alpine и postgres alpine
- ***Frontend:***
    - Vue - мощный фреймворк для создания SPA
    - Docker образ node alpine

#### Обоснование выбора стека
Данный стек позволяет ускорить разработку приложение. Djoser - позволяет быстро настраивать регистрацию и аутентификацию.
В данной работе, для аутентификации используются дуфолтные токены, но в переспективе мы можем беспроблем перейти на JWT.
Все ответы приходят с backend API в виде JSON, которые обрабатывает front.
Выбор vue.js был обусловлен мною, т.к. я его немного знаю, а также можно было использовать любой другой фреймвок.

#### Дополнения в реализации API
Помимо создания и получения заметок, их можно удалять и изменять.

#### Основные компоненты

- config - общая конфигурация приложения и настройки DRF, Django, Djoser.

- customuser - в данном компоненте был переопределён дефолтный user, email стал основным полем.

- notes - в данном компоненте определена логика работы с записками.

#### Работа с API
- для удобства разрабоки на frontend всё было задокументировано с помощью swagger для получения информации по API необходимо порейти на ``/swagger/``
- для регистрации пользователя необходимо послать POST запрос на ``/auth/users/`` с email и password, при не удаче будет
получено сообщение об ощибке (например если уже есть пользователь с таким email).
- для аутентификаии необходимо послать POST запрос на ``/auth/token/login/`` с email и password, в ответ будет получен token.
С помощью которого будет определяться авторизация пользователя.
- для выхода необходимо послать запрос POST запрос на ``/auth/users/`` с token в headers.
token присвоиный сервером в headers с каждым запросом в поле Authorization. Хранением и отправкой токена занимается Frontend.
- для получения списка заметок (GET) или создания (POST) необходимо послать запрос  на ``/api/v1/notes/`` в headers указав токен, возвращены будут только
те заетки, которыми владеет пользователь, а при создании благодаря токену система распознаст пользователя и присвоит заметке пользователя перед созданием.
- для изменения (PATCH, PUT), получения конкретной записки (GET) необходимо послать соответствующий запрос на
``/api/v1/notes/<id>``, где id - это id заметки, также необходим токен. (в случае отсутствия токена система выдаст ошибку)
- для получения количества необходимо послать запрос GET на ``/api/v1/notescount/`` с указанием токена, можно было бы
количество постов получать одновременно с постами с помощью annotate при получении списка, но получение количества требуется в разные моменты времени.

#### Тестирование Backend API

Было произведено тестирование компонентов системы с помщью Postman.

#### Особенности:

- автодукоментация с помощью swagger упрощает взаимодействие между frontend разработчиком и backend.

- djoser это очень удобный иснтсрумент, который быстро позволяет настроить пользовательскую регистрацию и аутентификацию,
плюс поддержка JWT и Auth Token Based. Задатки на расширение: сброс пароля, активация по email.

- токены упрощают взаимодействие между пользователем и сервером, по нему сервер определяет, что это за пользователь.

- настрока cors была произведена с помщью django-cors-headers.
CORS — это механизм безопасности, который позволяет веб-странице из одного домена обращаться к
 ресурсу с другим доменом (кросс-доменным запросом). Тоесть в config.settings был сформирован список доменнов,
 которые могут отправлять запросы на Backend API.

- использоваени JSON упрощает работу frontend ведь это по факту объект javascript.

- личный профит для меня, давно хотел разобраться с docker и взаимодействием между frontend и backend.

## Старт Backend API c Docker

Конфигурация приложения оставлена в режиме разработки. Проверьте, чтобы entrypoint.sh был LF, а не CRLF, в windows
столкнулся с данной ошибкой.

#### 1) Создать образ

    docker-compose build

##### 2) Запустить контейнер

    docker-compose up
    
##### 3) Перейти по адресу

    http://127.0.0.1:8000/swagger/
    
##### 4) Перейти в репозиторий, который хранит Frontend и следуя инструкциям запустить его
    
    https://github.com/ismirnov56/testworksimbirsoftfrontend


## Старт без API Docker

Конфигурация приложения оставлена в режиме разработки. Для данного старта не требуется postgres по дефолту настроен sqlite

#### 1) Создание окружения

    pip install virtualenv
    python3 -m venv env
    env/bin/activate

##### 2) Установка нужных пакетов

    pip install -r requirements.txt
    
##### 3) Миграции

    python manage.py makemigrations
    python manage.py migrate
    
##### 4) Создание супер пользователя для доступа к Django Admin Panel

     python manage.py createsuperuser
    
##### 5) Запуск приложения
    
    python manage.py runserver
    
##### 6) Перейти по адресу

    http://127.0.0.1:8000/swagger/
    
##### 7) Перейти в репозиторий, который хранит Frontend и следуя инструкциям запустить его

    https://github.com/ismirnov56/testworksimbirsoftfrontend

    
## Заключение

Хорошее тестовое задание. Давно хотел разобраться в некоторых вещах и вы меня дополнительно к этому замотивировали.
И спасибо за то, что можно было переопределить стек, это несковывает, а наоборот двигает вперед и даёт
шанс пополной применить свои знания и изучить что-то новое. Но единственное пока непонятное для меня осталось в ТЗ,
почему надо логинить пользователя после регистрации без перехода на страницу для автозации. Буду рад обратной связи. 
